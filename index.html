<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chess Game</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/17.0.2/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/17.0.2/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.26.0/babel.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        .chessboard {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            width: 400px;
            height: 400px;
            border: 4px solid #333;
        }
        .square {
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            cursor: move;
        }
        .light {
            background-color: #f0d9b5;
        }
        .dark {
            background-color: #b58863;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const INITIAL_BOARD = [
            ['♜', '♞', '♝', '♛', '♚', '♝', '♞', '♜'],
            ['♟', '♟', '♟', '♟', '♟', '♟', '♟', '♟'],
            ...Array(4).fill(Array(8).fill('')),
            ['♙', '♙', '♙', '♙', '♙', '♙', '♙', '♙'],
            ['♖', '♘', '♗', '♕', '♔', '♗', '♘', '♖']
        ];

        const isValidPawnMove = (startRow, startCol, endRow, endCol, piece) => {
            const isWhitePawn = piece === '♙';
            const direction = isWhitePawn ? -1 : 1;
            const startingRow = isWhitePawn ? 6 : 1;

            // Move one square forward
            if (startCol === endCol && endRow === startRow + direction) {
                return true;
            }

            // Move two squares forward from starting position
            if (startCol === endCol && startRow === startingRow && endRow === startRow + 2 * direction) {
                return true;
            }

            return false;
        };

        const ChessPiece = ({ piece, onDragStart }) => (
            <div
                draggable
                onDragStart={onDragStart}
                style={{ cursor: 'move' }}
            >
                {piece}
            </div>
        );

        const ChessSquare = ({ piece, isLight, onDragOver, onDrop, onDragStart }) => (
            <div
                className={`square ${isLight ? 'light' : 'dark'}`}
                onDragOver={onDragOver}
                onDrop={onDrop}
            >
                {piece && (
                    <ChessPiece
                        piece={piece}
                        onDragStart={onDragStart}
                    />
                )}
            </div>
        );

        const Chessboard = () => {
            const [board, setBoard] = React.useState(INITIAL_BOARD);
            const [draggedPiece, setDraggedPiece] = React.useState(null);

            const handleDragStart = (e, piece, row, col) => {
                setDraggedPiece({ piece, row, col });
                e.dataTransfer.setData('text/plain', piece);
            };

            const handleDragOver = (e) => {
                e.preventDefault();
            };

            const handleDrop = (e, targetRow, targetCol) => {
                e.preventDefault();
                if (draggedPiece) {
                    const { piece, row: startRow, col: startCol } = draggedPiece;
                    let isValidMove = true;

                    // Apply pawn movement rule
                    if (piece === '♙' || piece === '♟') {
                        isValidMove = isValidPawnMove(startRow, startCol, targetRow, targetCol, piece);
                    }

                    if (isValidMove) {
                        const newBoard = board.map(row => [...row]);
                        newBoard[startRow][startCol] = '';
                        newBoard[targetRow][targetCol] = piece;
                        setBoard(newBoard);
                    }
                    setDraggedPiece(null);
                }
            };

            return (
                <div className="chessboard">
                    {board.map((row, rowIndex) =>
                        row.map((piece, colIndex) => (
                            <ChessSquare
                                key={`${rowIndex}-${colIndex}`}
                                piece={piece}
                                isLight={(rowIndex + colIndex) % 2 === 0}
                                onDragOver={handleDragOver}
                                onDrop={(e) => handleDrop(e, rowIndex, colIndex)}
                                onDragStart={(e) => handleDragStart(e, piece, rowIndex, colIndex)}
                            />
                        ))
                    )}
                </div>
            );
        };

        ReactDOM.render(<Chessboard />, document.getElementById('root'));
    </script>
</body>
</html>
